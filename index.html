<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ev Stok & Envanter YÃ¶netimi</title>
    <style>
        :root { --primary: #2563eb; --success: #16a34a; --danger: #dc2626; --bg: #f8fafc; --warning: #f59e0b; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); padding: 10px; color: #1e293b; margin: 0; }
        .container { max-width: 900px; margin: auto; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        .add-panel { background: #eff6ff; padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #dbeafe; display: flex; gap: 8px; flex-wrap: wrap; }
        .add-panel input, .add-panel select { padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; flex: 1; min-width: 130px; }
        .btn-add { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }

        .search-bar { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; box-sizing: border-box; margin-bottom: 10px; }
        
        table { width: 100%; border-collapse: collapse; }
        th { background: #f1f5f9; padding: 12px; text-align: left; font-size: 12px; position: sticky; top: 0; z-index: 10; }
        td { padding: 10px; border-bottom: 1px solid #e2e8f0; font-size: 14px; }
        .cat-header { background: #f1f5f9 !important; font-weight: bold; color: var(--primary); border-left: 4px solid var(--primary); }
        
        input[type="number"] { width: 55px; padding: 5px; border: 1px solid #cbd5e1; border-radius: 4px; text-align: center; }
        .status-btn { padding: 6px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; cursor: pointer; display: inline-block; min-width: 120px; text-align: center; }
        .need-yes { background: #fee2e2; color: var(--danger); border: 1px solid var(--danger); }
        .need-no { background: #dcfce7; color: var(--success); border: 1px solid var(--success); }
        
        .delete-btn { color: var(--danger); cursor: pointer; font-weight: bold; margin-left: 10px; border: none; background: none; font-size: 16px; }
        .footer-btns { position: sticky; bottom: 0; background: white; padding: 15px; display: flex; justify-content: center; gap: 10px; border-top: 1px solid #e2e8f0; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; color: white; }
        
        #modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 25px; border-radius: 15px; box-shadow: 0 0 30px rgba(0,0,0,0.4); z-index: 1000; width: 85%; max-width: 400px; }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 999; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align: center; color: var(--primary);">ğŸ  Ev Stok YÃ¶netimi</h2>

    <div class="add-panel">
        <input type="text" id="newUrun" placeholder="ÃœrÃ¼n AdÄ±...">
        <select id="newCat">
            <option value="BAKLÄ°YAT & MAKARNA">BAKLÄ°YAT & MAKARNA</option>
            <option value="YAÄLAR">YAÄLAR</option>
            <option value="UN & ÅEKER">UN & ÅEKER</option>
            <option value="KAHVALTILIK">KAHVALTILIK</option>
            <option value="Ä°Ã‡ECEK">Ä°Ã‡ECEK</option>
            <option value="BAHARAT">BAHARAT</option>
            <option value="Ã‡AMAÅIR">Ã‡AMAÅIR</option>
            <option value="BULAÅIK">BULAÅIK</option>
            <option value="MUTFAK & BANYO">MUTFAK & BANYO</option>
            <option value="GENEL TEMÄ°ZLÄ°K">GENEL TEMÄ°ZLÄ°K</option>
            <option value="BANYO & HÄ°JYEN">BANYO & HÄ°JYEN</option>
            <option value="AÄIZ BAKIMI">AÄIZ BAKIMI</option>
            <option value="KADIN HÄ°JYEN">KADIN HÄ°JYEN</option>
            <option value="EL, YÃœZ & VÃœCUT">EL, YÃœZ & VÃœCUT</option>
            <option value="DEODORANT & PARFÃœM">DEODORANT & PARFÃœM</option>
            <option value="SAÃ‡ BAKIM & ÅEKÄ°L">SAÃ‡ BAKIM & ÅEKÄ°L</option>
            <option value="KOZMETÄ°K & MAKYAJ">KOZMETÄ°K & MAKYAJ</option>
            <option value="TIRAÅ ÃœRÃœNLERÄ°">TIRAÅ ÃœRÃœNLERÄ°</option>
            <option value="BEBEK">BEBEK</option>
            <option value="BANYO & TUVALET">BANYO & TUVALET</option>
            <option value="MUTFAK & GENEL">MUTFAK & GENEL</option>
            <option value="HÄ°JYENÄ°K KAÄITLAR">HÄ°JYENÄ°K KAÄITLAR</option>
            <option value="YARDIMCI KAÄITLAR">YARDIMCI KAÄITLAR</option>
            <option value="DÄ°ÄER">DÄ°ÄER</option>
        </select>
        <input type="text" id="newUnit" placeholder="Birim..." style="max-width: 80px;">
        <button class="btn-add" onclick="addNewProduct()">â• EKLE</button>
    </div>

    <input type="text" id="searchInput" class="search-bar" placeholder="ÃœrÃ¼nlerde ara..." onkeyup="filterProducts()">

    <table>
        <thead>
            <tr>
                <th>ÃœrÃ¼n</th>
                <th>Birim</th>
                <th>Miktar</th>
                <th>Ä°htiyaÃ§ Durumu</th>
            </tr>
        </thead>
        <tbody id="listBody"></tbody>
    </table>
</div>

<div class="footer-btns">
    <button class="btn" style="background: var(--warning);" onclick="showMissing()">ğŸ“ EKSÄ°K LÄ°STESÄ°</button>
    <button class="btn" style="background: var(--success);" onclick="exportExcel()">ğŸ“Š EXCEL</button>
</div>

<div id="overlay" onclick="closeModal()"></div>
<div id="modal">
    <h3>ğŸ›’ AlÄ±nacaklar</h3>
    <div id="modal-content" style="white-space: pre-wrap; margin-bottom: 15px; max-height: 200px; overflow-y: auto;"></div>
    <button class="btn" style="width: 100%; background: var(--primary);" onclick="copyText()">ğŸ“‹ KOPYALA</button>
    <button class="btn" style="width: 100%; background: #666; margin-top: 5px;" onclick="closeModal()">KAPAT</button>
</div>

<script>
const categoryOrder = [
    "BAKLÄ°YAT & MAKARNA", "YAÄLAR", "UN & ÅEKER", "KAHVALTILIK", "Ä°Ã‡ECEK", "BAHARAT",
    "Ã‡AMAÅIR", "BULAÅIK", "MUTFAK & BANYO", "GENEL TEMÄ°ZLÄ°K", "BANYO & HÄ°JYEN",
    "AÄIZ BAKIMI", "KADIN HÄ°JYEN", "EL, YÃœZ & VÃœCUT", "DEODORANT & PARFÃœM",
    "SAÃ‡ BAKIM & ÅEKÄ°L", "KOZMETÄ°K & MAKYAJ", "TIRAÅ ÃœRÃœNLERÄ°", "BEBEK",
    "BANYO & TUVALET", "MUTFAK & GENEL", "HÄ°JYENÄ°K KAÄITLAR", "YARDIMCI KAÄITLAR", "DÄ°ÄER"
];

const defaultData = [
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "PirinÃ§", unit: "kg"},
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "KÄ±rmÄ±zÄ± Mercimek", unit: "kg" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "Nohut", unit: "kg"},
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "Kuru Fasulye", unit: "kg" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "PilavlÄ±k Bulgur", unit: "kg" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "KÃ¶ftelik Bulgur", unit: "kg" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "Makarna (Spagetti)", unit: "ad" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "Makarna (Burgu/Fiyonk)", unit: "ad" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "Arpa Åehriye", unit: "ad"},
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "Tel Åehriye", unit: "ad" },
    { cat: "BAKLÄ°YAT & MAKARNA", urun: "SalÃ§a", unit: "kg" },
    { cat: "YAÄLAR", urun: "AyÃ§iÃ§ek YaÄŸÄ±(5lt)", unit: "ad"},
    { cat: "YAÄLAR", urun: "AyÃ§iÃ§ek YaÄŸÄ±(1lt)", unit: "ad" },
    { cat: "YAÄLAR", urun: "ZeytinyaÄŸÄ±", unit: "lt" },
    { cat: "YAÄLAR", urun: "TereyaÄŸÄ±", unit: "ad" },
    { cat: "UN & ÅEKER", urun: "BuÄŸday Unu", unit: "ad/kg" },
    { cat: "UN & ÅEKER", urun: "MÄ±sÄ±r Unu", unit: "ad" },
    { cat: "UN & ÅEKER", urun: "NiÅŸasta", unit: "ad" },
    { cat: "UN & ÅEKER", urun: "Toz Åeker", unit: "ad/kg" },
    { cat: "KAHVALTILIK", urun: "Peynir Ã‡eÅŸitleri", unit: "ad" },
    { cat: "KAHVALTILIK", urun: "Zeytin (S/Y)", unit: "ad" },
    { cat: "KAHVALTILIK", urun: "Yumurta", unit: "ad" },
    { cat: "Ä°Ã‡ECEK", urun: "Siyah Ã‡ay(1kg)", unit: "ad" },
    { cat: "Ä°Ã‡ECEK", urun: "TÃ¼rk Kahvesi", unit: "ad" },
    { cat: "Ä°Ã‡ECEK", urun: "Filtre Kahve", unit: "ad" },
    { cat: "Ä°Ã‡ECEK", urun: "GranÃ¼l Kahve", unit: "ad" },
    { cat: "Ä°Ã‡ECEK", urun: "Sade Maden Suyu", unit: "ad" },
    { cat: "Ä°Ã‡ECEK", urun: "Meyveli Maden Suyu", unit: "ad" },
    { cat: "BAHARAT", urun: "Tuz(Ã¶ÄŸÃ¼tÃ¼lmÃ¼ÅŸ)", unit: "ad"},
    { cat: "BAHARAT", urun: "Tuz(iri taneli)", unit: "ad" },
    { cat: "BAHARAT", urun: "Karabiber", unit: "ad"},
    { cat: "BAHARAT", urun: "Pul Biber", unit: "ad"},
    { cat: "BAHARAT", urun: "Kekik / Nane", unit: "ad" },
    { cat: "BAHARAT", urun: "Kimyon / Sumak", unit: "ad"},
    { cat: "BAHARAT", urun: "Zencefil/ZerdeÃ§al", unit: "ad"},
    { cat: "BAHARAT", urun: "TarÃ§Ä±n", unit: "ad" },
    { cat: "BAHARAT", urun: "Susam", unit: "ad" },
    { cat: "BAHARAT", urun: "Karanfil", unit: "ad" },
    { cat: "BAHARAT", urun: "Ã‡Ã¶rek otu", unit: "ad" },
    { cat: "Ã‡AMAÅIR", urun: "Toz Deterjan", unit: "ad/kg" },
    { cat: "Ã‡AMAÅIR", urun: "SÄ±vÄ± Deterjan", unit: "ad/lt" },
    { cat: "Ã‡AMAÅIR", urun: "YumuÅŸatÄ±cÄ±", unit: "ad/lt" },
    { cat: "Ã‡AMAÅIR", urun: "Renkli Koruyucu", unit: "ad/lt" },
    { cat: "Ã‡AMAÅIR", urun: "Ã‡amaÅŸÄ±r Suyu", unit: "ad"},
    { cat: "Ã‡AMAÅIR", urun: "Makine Temizleyici", unit: "ad" },
    { cat: "BULAÅIK", urun: "Elde YÄ±kama SÄ±vÄ±sÄ±", unit: "ad" },
    { cat: "BULAÅIK", urun: "ParlatÄ±cÄ±", unit: "ad" },
    { cat: "BULAÅIK", urun: "BulaÅŸÄ±k Makinesi Tuzu", unit: "ad" },
    { cat: "BULAÅIK", urun: "Makine Tableti", unit: "ad"},
    { cat: "BULAÅIK", urun: "Mutfak SÃ¼ngeri / Tel", unit: "ad" },
    { cat: "MUTFAK & BANYO", urun: "YaÄŸ Ã‡Ã¶zÃ¼cÃ¼ Sprey", unit: "ad" },
    { cat: "MUTFAK & BANYO", urun: "Banyo Ã‡Ã¶zÃ¼cÃ¼ Sprey", unit: "ad" },
    { cat: "MUTFAK & BANYO", urun: "Cif / Krem", unit: "ad" },
    { cat: "MUTFAK & BANYO", urun: "Lavabo AÃ§Ä±cÄ±", unit: "ad" },
    { cat: "GENEL TEMÄ°ZLÄ°K", urun: "YÃ¼zey Temizleyici", unit: "ad" },
    { cat: "GENEL TEMÄ°ZLÄ°K", urun: "Cam Temizleyici", unit: "ad" },
    { cat: "GENEL TEMÄ°ZLÄ°K", urun: "Arap Sabunu", unit: "ad" },
    { cat: "GENEL TEMÄ°ZLÄ°K", urun: "Ã‡ok AmaÃ§lÄ± Sprey", unit: "ad" },
    { cat: "GENEL TEMÄ°ZLÄ°K", urun: "Temizlik Bezi", unit: "ad"},
    { cat: "GENEL TEMÄ°ZLÄ°K", urun: "Ã‡Ã¶p TorbasÄ±", unit: "ad" },
    { cat: "BANYO & HÄ°JYEN", urun: "Åampuan", unit: "ad" },
    { cat: "BANYO & HÄ°JYEN", urun: "SaÃ§ Kremi", unit: "ad" },
    { cat: "BANYO & HÄ°JYEN", urun: "DuÅŸ Jeli", unit: "ad" },
    { cat: "BANYO & HÄ°JYEN", urun: "Sabun (SÄ±vÄ±/KatÄ±)", unit: "ad" },
    { cat: "AÄIZ BAKIMI", urun: "DiÅŸ Macunu", unit: "ad" },
    { cat: "AÄIZ BAKIMI", urun: "DiÅŸ FÄ±rÃ§asÄ± (Yedek)", unit: "ad" },
    { cat: "AÄIZ BAKIMI", urun: "AÄŸÄ±z Ã‡alkalama Suyu", unit: "ad" },
    { cat: "AÄIZ BAKIMI", urun: "DiÅŸ Ä°pi", unit: "ad" },
    { cat: "KADIN HÄ°JYEN", urun: "Hijyenik Ped", unit: "ad" },
    { cat: "KADIN HÄ°JYEN", urun: "GÃ¼nlÃ¼k Ped", unit: "ad" },
    { cat: "EL, YÃœZ & VÃœCUT", urun: "El ve VÃ¼cut Kremi", unit: "ad" },
    { cat: "EL, YÃœZ & VÃœCUT", urun: "YÃ¼z YÄ±kama Jeli", unit: "ad" },
    { cat: "EL, YÃœZ & VÃœCUT", urun: "GÃ¼neÅŸ Kremi", unit: "ad" },
    { cat: "EL, YÃœZ & VÃœCUT", urun: "Dudak Nemlendiricisi", unit: "ad" },
    { cat: "DEODORANT & PARFÃœM", urun: "Deodorant / Roll-on", unit: "ad" },
    { cat: "DEODORANT & PARFÃœM", urun: "ParfÃ¼m / VÃ¼cut Spreyi", unit: "ad" },
    { cat: "SAÃ‡ BAKIM & ÅEKÄ°L", urun: "SaÃ§ KÃ¶pÃ¼ÄŸÃ¼ / JÃ¶le", unit: "ad" },
    { cat: "SAÃ‡ BAKIM & ÅEKÄ°L", urun: "SaÃ§ BoyasÄ±", unit: "ad" },
    { cat: "KOZMETÄ°K & MAKYAJ", urun: "Pamuk (Makyaj)", unit: "ad" },
    { cat: "KOZMETÄ°K & MAKYAJ", urun: "Makyaj Temizleme Suyu", unit: "ad" },
    { cat: "KOZMETÄ°K & MAKYAJ", urun: "Kulak Ã‡ubuÄŸu", unit: "ad" },
    { cat: "KOZMETÄ°K & MAKYAJ", urun: "Aseton", unit: "ad" },
    { cat: "TIRAÅ ÃœRÃœNLERÄ°", urun: "TÄ±raÅŸ BÄ±Ã§aÄŸÄ±", unit: "ad" },
    { cat: "TIRAÅ ÃœRÃœNLERÄ°", urun: "TÄ±raÅŸ KÃ¶pÃ¼ÄŸÃ¼ / Jeli", unit: "ad" },
    { cat: "BEBEK", urun: "Bebek Bezi", unit: "ad" },
    { cat: "BEBEK", urun: "Islak Mendil", unit: "ad" },
    { cat: "BEBEK", urun: "PiÅŸik Kremi", unit: "ad" },
    { cat: "BANYO & TUVALET", urun: "Tuvalet KaÄŸÄ±dÄ±", unit: "rulo" },
    { cat: "MUTFAK & GENEL", urun: "KaÄŸÄ±t Havlu", unit: "rulo" },
    { cat: "HÄ°JYENÄ°K KAÄITLAR", urun: "KaÄŸÄ±t Mendil", unit: "ad" },
    { cat: "YARDIMCI KAÄITLAR", urun: "PiÅŸirme KaÄŸÄ±dÄ±", unit: "ad" },
    { cat: "YARDIMCI KAÄITLAR", urun: "BuzdolabÄ± PoÅŸeti", unit: "ad" },
    { cat: "YARDIMCI KAÄITLAR", urun: "StreÃ§ Film", unit: "ad" }
];

let storage = JSON.parse(localStorage.getItem('evEnvanter_vFinal')) || defaultData.map(p => ({...p, qty: 0, need: false, custom: false}));

function init() {
    const list = document.getElementById('listBody');
    list.innerHTML = '';
    let lastCat = '';

    // GitHub'daki index.html dosyanÄ±zÄ±n iÃ§indeki ÅŸu kÄ±smÄ± bulun ve bununla deÄŸiÅŸtirin:
// Eski: storage.sort((a, b) => categoryOrder.indexOf(a.cat) - categoryOrder.indexOf(b.cat));
// Yeni (Daha uyumlu):
storage.sort(function(a, b) {
    return categoryOrder.indexOf(a.cat) - categoryOrder.indexOf(b.cat);
});

// Eski: storage.forEach((item, i) => { ... });
// Yeni (Daha uyumlu):
for (var i = 0; i < storage.length; i++) {
    var item = storage[i];
    // ... (diÄŸer kodlar aynÄ± kalacak ÅŸekilde dÃ¶ngÃ¼ yapÄ±sÄ±)
}
    });

    storage.forEach((item, i) => {
        if(item.cat !== lastCat) {
            const catRow = document.createElement('tr');
            catRow.className = 'cat-header';
            catRow.innerHTML = `<td colspan="4">${item.cat}</td>`;
            list.appendChild(catRow);
            lastCat = item.cat;
        }

        const row = document.createElement('tr');
        row.innerHTML = `
            <td>
                ${item.urun} 
                ${item.custom ? `<button class="delete-btn" onclick="deleteProduct(${i})">ğŸ—‘ï¸</button>` : ''}
            </td>
            <td>${item.unit}</td>
            <td><input type="number" step="0.1" value="${item.qty}" oninput="update(${i}, 'qty', this.value)"></td>
            <td>
                <span class="status-btn ${item.need ? 'need-yes' : 'need-no'}" onclick="update(${i}, 'need', !storage[${i}].need)">
                    ${item.need ? 'âš ï¸ Ä°HTÄ°YAÃ‡ VAR' : 'âœ… Ä°HTÄ°YAÃ‡ DEÄÄ°L'}
                </span>
            </td>
        `;
        list.appendChild(row);
    });
}

function addNewProduct() {
    const name = document.getElementById('newUrun').value.trim();
    const cat = document.getElementById('newCat').value;
    const unit = document.getElementById('newUnit').value || 'ad';

    if(!name) { alert("ÃœrÃ¼n adÄ± boÅŸ olamaz!"); return; }

    storage.push({ cat, urun: name, unit, qty: 0, need: false, custom: true });
    save();
    document.getElementById('newUrun').value = '';
    init();
}

function update(i, key, val) {
    storage[i][key] = (key === 'qty') ? (parseFloat(val) || 0) : val;
    save();
    if(key === 'need') init(); 
}

function deleteProduct(i) {
    if(confirm("Bu Ã¼rÃ¼nÃ¼ silmek istediÄŸine emin misin?")) {
        storage.splice(i, 1);
        save();
        init();
    }
}

function save() { localStorage.setItem('evEnvanter_vFinal', JSON.stringify(storage)); }

function filterProducts() {
    const term = document.getElementById('searchInput').value.toLowerCase();
    document.querySelectorAll('#listBody tr').forEach(row => {
        if(!row.classList.contains('cat-header')) {
            row.style.display = row.innerText.toLowerCase().includes(term) ? '' : 'none';
        }
    });
}

function showMissing() {
    const missing = storage.filter(item => item.need);
    const content = document.getElementById('modal-content');
    content.innerText = missing.length ? missing.map(m => `â€¢ ${m.urun} (Eldeki: ${m.qty} ${m.unit})`).join('\n') : "Eksik yok!";
    document.getElementById('modal').style.display = 'block';
    document.getElementById('overlay').style.display = 'block';
}

function closeModal() {
    document.getElementById('modal').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
}

function copyText() {
    navigator.clipboard.writeText(document.getElementById('modal-content').innerText).then(() => alert("KopyalandÄ±!"));
}

function exportExcel() {
    let csv = "Kategori\tÃœrÃ¼n\tMiktar\tBirim\tDurum\n";
    storage.forEach(m => csv += `${m.cat}\t${m.urun}\t${m.qty}\t${m.unit}\t${m.need?'Ä°HTÄ°YAÃ‡ VAR':'Ä°HTÄ°YAÃ‡ YOK'}\n`);
    const blob = new Blob(['\ufeff' + csv], { type: 'application/vnd.ms-excel' });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "Stok_Listesi.xls";
    a.click();
}

init();
</script>
</body>

</html>
